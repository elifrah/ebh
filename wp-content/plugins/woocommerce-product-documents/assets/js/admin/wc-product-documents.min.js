jQuery(document).ready(function(e){"use strict";function t(){e(".wc-product-documents-sections .wc-product-documents-section").each(function(t,n){e(".product-documents-section-position",n).val(parseInt(e(n).index(".wc-product-documents-sections .wc-product-documents-section")))})}function n(t){e(".wc-product-documents .wc-product-document",t).each(function(t,n){e(".wc-product-document-position",n).val(parseInt(e(n).index(".wc-product-documents .wc-product-document")))})}function s(){e("#wc-product-documents-data .wc-product-documents-set-file").live("click",function(t){t.preventDefault();i=e(t.target).closest("tr");if(r){r.open();return}r=wp.media.frames.file_frame=wp.media({title:wc_product_documents_admin_params.select_file_text,button:{text:wc_product_documents_admin_params.set_file_text},multiple:!1});r.on("select",function(){var t=r.state().get("selection").first().toJSON();e("input.wc-product-document-file-location",i).val(t.url)});r.open()})}e("#wc-product-documents-data .wc-metaboxes-wrapper").on("click",".expand_all",function(t){e(this).closest(".wc-metaboxes-wrapper").find(".wc-metabox > .wc-metabox-content").show();return!1}).on("click",".close_all",function(t){e(this).closest(".wc-metaboxes-wrapper").find(".wc-metabox > .wc-metabox-content").hide();return!1});e("#wc-product-documents-data").on("click",".add-new-product-documents-section",function(){var n=-1;e(".wc-product-documents-sections .wc-product-documents-section .product-documents-section-index").each(function(){var t=parseInt(e(this).val());n=t>n?t:n});n++;var r=wc_product_documents_admin_params.new_section.replace(/{index}/g,n);e(".wc-product-documents-sections").append(r);t();return!1}).on("click",".remove-wc-product-documents-section",function(){var n=confirm(wc_product_documents_admin_params.confirm_remove_section_text);if(n){var r=e(this).closest(".wc-product-documents-section");e(r).remove();t()}return!1}).on("click","input.product-documents-default-section",function(){var t="true"===e(this).attr("previousValue");e("#wc-product-documents-data input.product-documents-default-section").attr("previousValue",!1);t?e(this).removeAttr("checked"):e(this).attr("previousValue",e(this).is(":checked"));return!0});e("#wc-product-documents-data input.product-documents-default-section").each(function(){e(this).is(":checked")&&e(this).attr("previousValue",!0)});e(".wc-product-documents-sections").sortable({items:".wc-product-documents-section",cursor:"move",axis:"y",handle:"h3",scrollSensitivity:40,helper:function(e,t){return t},start:function(e,t){t.item.css("border-style","dashed")},stop:function(e,n){n.item.removeAttr("style");t()}});e("#wc-product-documents-data").on("click",".wc-product-documents-add-document",function(){var t=e(this).closest(".wc-product-documents-section"),r=e(".product-documents-section-index",t).val(),i=-1;e(".wc-product-document .wc-product-document-sub-index",t).each(function(){var t=parseInt(e(this).val());i=t>i?t:i});i++;var o=wc_product_documents_admin_params.new_document.replace(/{index}/g,r).replace(/{sub_index}/g,i);e(this).closest(".wc-product-documents").append(o);n(t);s();return!1}).on("click",".wc-product-documents-remove-document",function(){var t=confirm(wc_product_documents_admin_params.confirm_remove_document_text);if(t){var r=e(this).closest(".wc-product-documents-section"),i=e(this).closest(".wc-product-document");i.remove();n(r)}return!1});e("table.wc-product-documents tbody").sortable({items:"tr",cursor:"move",axis:"y",handle:"td",scrollSensitivity:40,helper:function(e,t){return t},start:function(e,t){t.item.css("background-color","#f6f6f6")},stop:function(e,t){t.item.removeAttr("style");n()}});var r,i;s()});